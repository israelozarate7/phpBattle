# From Apache to Nginx {Web Servers} (Second session)

####Enter into the Vagrant machine
- Concatening variables is faster than just putting them in a double-quotation mark string.
```
vagrant ssh
```
####Install nginx (php5-fpm)
```
echo "deb http://ppa.launchpad.net/nginx/stable/ubuntu $(lsb_release -sc) main" | sudo tee /etc/apt/sources.list.d/nginx-stable.list
sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys C300EE8C
sudo apt-get update
sudo apt-get install nginx php5-fpm
```

#### Edit two configuration files
- Go to /etc/php5/fpm/pool.d/www.conf and uncomment this line:
```
listen.mode = 0660
```
- Go to /etc/php5/fpm/php.ini and add this line:
```
cgi.fix_pathinfo=0
```
#### Configure correctly the default file of nginx
- Go to /etc/nginx/site-available/default
```
server {
        listen 80 default_server;
        listen [::]:80 default_server;

        # SSL configuration
        #
        # listen 443 ssl default_server;
        # listen [::]:443 ssl default_server;
        #
        # Note: You should disable gzip for SSL traffic.
        # See: https://bugs.debian.org/773332
        #
        # Read up on ssl_ciphers to ensure a secure configuration.
        # See: https://bugs.debian.org/765782
        #
        # Self signed certs generated by the ssl-cert package
        # Don't use them in a production server!
        #
        # include snippets/snakeoil.conf;

        root /var/www/public;

        # Add index.php to the list if you are using PHP
        index index.php index.html index.htm index.nginx-debian.html;

        server_name _;

        location / {
                # First attempt to serve request as file, then
                # as directory, then fall back to displaying a 404.
                try_files $uri $uri/ =404;
        }

        # pass PHP scripts to FastCGI server
        #
        location ~ \.php$ {
                include snippets/fastcgi-php.conf;

        #       # With php-fpm (or other unix sockets):
                fastcgi_pass unix:/var/run/php/php7.0-fpm.sock;
        #       # With php-cgi (or other tcp sockets):
        #       fastcgi_pass 127.0.0.1:9000;
        }

        # deny access to .htaccess files, if Apache's document root
        # concurs with nginx's one
        #
        location ~ /\.ht {
                deny all;
        }
}
```
#### Restart services (nginx and php5-fpm)
```
Service nginx stop
Service nginx start
Service php5-fpm stop
Service php5-fpm start

```
#### Stop apache2 service
```
Service apache2 stop
```
#### Check if nginx is working correctly
- Go to http://192.168.33.10/whateveryouwant.php
- If everything is correct you can see an simple nginx error:
```
404 Not Found
nginx/1.12.1
```